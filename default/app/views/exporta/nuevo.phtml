<?phpheader('Content-Type: application/vdn.ms-excel');header('Content-Disposition: attachment; filename=reporte.xls');Load::lib('PHPExcel');$excel = new PHPExcel();$excel->getProperties()->setCreator('SantaFe')->setLastModifiedBy('SantaFe')->setTitle('Reporte');$excel->setActiveSheetIndex(0);$pagina = $excel->getActiveSheet();$pagina->setTitle('Reporte');$pagina->setCellValue('A1','Nº Sol');$pagina->setCellValue('B1','U. de Negocio');$pagina->setCellValue('C1','F. Solicitud');$pagina->setCellValue('D1','F. Entrega');$pagina->setCellValue('E1','Patente');$pagina->setCellValue('F1','Vehiculo');$pagina->setCellValue('G1','Rendimiento');$pagina->setCellValue('H1','T. Mardor');$pagina->setCellValue('I1','Operador');$pagina->setCellValue('J1','Ubicacion');$pagina->setCellValue('K1','Trabajo');$pagina->setCellValue('L1','L. Solicitados');$pagina->setCellValue('M1','L. Asignados');$pagina->setCellValue('N1','L. Cargados');$pagina->setCellValue('O1','Carga');$pagina->setCellValue('P1','Surtidor');$pagina->setCellValue('Q1','F. de Carga');$pagina->setCellValue('R1','Nº vale');$pagina->setCellValue('S1','H. Actual');$pagina->setCellValue('T1','Q. Recibe');$pagina->getStyle('A1:T1')->getFont()->setBold(TRUE);$pagina->getStyle('A1:T1')->getFont()->setSize(12);$i = 1;foreach ($busqueda as $items):    $i++;    $pagina->setCellValue('A'.$i, $items->solicitud_id);    foreach ($unegocio as $items1):        if ($items->unegocio_id == $items1->id) {            $pagina->setCellValue('B'.$i, $items1->nombre);        }    endforeach;        $pagina->setCellValue('C'.$i, $items->fecha);    $pagina->setCellValue('D'.$i, $items->fentrega);    foreach ($vehiculos as $items4):        if ($items->vehiculos_id == $items4->id) {            $pagina->setCellValue('E'.$i, $items4->patente);            $pagina->setCellValue('F'.$i, $items4->rinde);            $pagina->setCellValue('G'.$i, $items4->tmarcador);        }    endforeach;    foreach ($vehiculos as $items2):        if ($items->vehiculos_id == $items2->id) {            $pagina->setCellValue('H'.$i, $items2->marca . " " . $items2->modelo);        }    endforeach;        $pagina->setCellValue('I'.$i, $items->operador);    $pagina->setCellValue('J'.$i, $items->ubicacion);    $pagina->setCellValue('K'.$i, $items->trabajo);    $pagina->setCellValue('L'.$i, $items->litros);    $pagina->setCellValue('M'.$i, $items->lasignados);    $pagina->setCellValue('N'.$i, $items->lcargados);    if ($items->carga == 0) {        $pagina->setCellValue('O'.$i, 'Carga');    }else{        $pagina->setCellValue('O'.$i, 'No Carga');    }    foreach ($camiones as $items3):        if ($items->camiones_id == $items3->id) {            $pagina->setCellValue('P'.$i, $items3->marca . " " . $items3->modelo);        }    endforeach;    $pagina->setCellValue('Q'.$i, $items->frentrega);    $pagina->setCellValue('R'.$i, $items->nvale);    $pagina->setCellValue('S'.$i, $items->hactual);    $pagina->setCellValue('T'.$i, $items->qrecibe);endforeach;foreach (range('A', 'T') as $column):    $pagina->getColumnDimension($column)->setAutoSize(TRUE);endforeach;$objWriter = PHPExcel_IOFactory::createWriter($excel, 'Excel5');$objWriter->save('php://output');